syntax = "proto3";

package imageprocessing;

service ImageProcessing {
    // define the process of taking in image(s) from navigation system 
    // and sending out masks to downstream system
    
    rpc singleTrack(Img) returns (Tracks) {} 
    // a single call to the server with a single image, return tracking information 
    rpc singleMask(Img) returns (MasksTracks) {}
    // a single call to the server with a single image, return tracking and mask information

    rpc continuousTrack(stream Img) returns (stream Tracks) {}
    // a continuous stream of images, return tracking information
    rpc continuousMask(stream Img) returns (stream MasksTracks) {}
    // a continuous stream of images, return tracking and mask information

    rpc continuousInfo(stream Img) returns (stream MasksTracks) {}
    // a unified implementation of both continuousTrack and continuousMask
}

message Img {
    bytes timeStamp = 1;
    bytes img = 2; 
    bool requiresMasks = 3;
}

message Tracks {
    bytes timeStamp = 1;
    bytes tracks = 2;
    // return type with no mask  
}

message MasksTracks {
    bytes timeStamp = 1;
    repeated TrackRow tracks = 2;
}

message TrackRow {
    float x1 = 1;
    float y1 = 2;
    float x2 = 3;
    float y2 = 4;
    string trackId = 5;
    float conf = 6;
    string cls = 7;
    repeated Masks mask = 8;
}

message Masks {
    int32 x = 1;
    int32 y = 2;
}
